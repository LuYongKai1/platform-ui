# 活动批次管理设计方案

## 概述

根据您的需求，我为您设计了一个完整的活动批次管理系统，支持以下功能：

1. **针对特定活动创建批次**
2. **查看每个活动下的批次列表**
3. **查看所有批次的统一列表**

## 设计架构

### 1. API 接口设计

#### 新增 API
- `fetchGetGiftBatchListByActivity(params)` - 根据活动ID获取批次列表
- 增强现有的批次管理 API

#### 现有 API
- `fetchGetGiftBatchList()` - 获取所有批次列表
- `fetchAddGiftBatch()` - 新增批次
- `fetchUpdateGiftBatch()` - 更新批次
- `fetchDeleteGiftBatch()` - 删除批次
- `fetchGenerateGiftCodes()` - 生成兑换码
- `fetchExportGiftCodes()` - 导出兑换码

### 2. 页面结构

#### 活动配置页面增强 (`src/views/giftmanage/giftactivityconfig/index.vue`)
- ✅ 在操作列增加"查看批次"按钮
- ✅ 集成活动批次管理抽屉组件

#### 活动批次管理抽屉 (`src/views/giftmanage/giftactivityconfig/modules/activity-batch-drawer.vue`)
- ✅ 显示特定活动的所有批次
- ✅ 支持为当前活动新增批次
- ✅ 支持批次的编辑、删除、生成兑换码、导出等操作
- ✅ 包含搜索和筛选功能

#### 独立批次管理页面 (`src/views/giftmanage/batch-management/index.vue`)
- ✅ 显示所有批次的统一列表
- ✅ 支持按活动、类型、状态等条件筛选
- ✅ 支持所有批次操作功能

#### 批次操作组件 (`modules/batch-operate-drawer.vue`)
- ✅ 统一的批次新增/编辑表单
- ✅ 支持选择关联活动
- ✅ 表单验证和错误处理

## 功能特性

### 1. 活动维度的批次管理
- 从活动列表页面点击"查看批次"
- 在抽屉中查看该活动的所有批次
- 可以为该活动直接创建新批次
- 批次会自动关联到当前活动

### 2. 全局批次管理
- 独立的批次管理页面
- 查看所有批次的统一列表
- 支持多维度筛选（活动、渠道、类型、状态等）
- 支持批量操作

### 3. 批次操作功能
- **新增批次**：创建新的兑换码批次
- **编辑批次**：修改批次信息
- **生成兑换码**：为批次生成指定数量的兑换码
- **导出兑换码**：导出已生成的兑换码到Excel
- **删除批次**：删除不需要的批次

### 4. 搜索和筛选
- 批次编码搜索
- 按关联活动筛选
- 按类型筛选（通码/专码）
- 按状态筛选
- 按时间范围筛选

## 使用流程

### 方式一：从活动管理进入
1. 进入"兑换码管理"页面
2. 找到目标活动，点击"查看批次"按钮
3. 在弹出的抽屉中查看该活动的所有批次
4. 点击"新增批次"为该活动创建新批次
5. 对批次进行生成兑换码、导出等操作

### 方式二：独立批次管理
1. 进入"批次管理"页面（需要在路由中配置）
2. 查看所有批次的统一列表
3. 使用搜索和筛选功能定位目标批次
4. 进行批次管理操作

## 数据流关系

```
活动 (Campaign)
    ↓ (一对多)
批次 (Batch)
    ↓ (一对多)
兑换码 (GiftCode)
```

- 一个活动可以有多个批次
- 一个批次包含多个兑换码
- 批次与活动通过 `campaignId` 关联

## 权限控制

系统已集成权限控制，支持以下权限：
- `operate:gift:batch:add` - 新增批次
- `operate:gift:batch:edit` - 编辑批次
- `operate:gift:batch:generate` - 生成兑换码
- `operate:gift:batch:export` - 导出兑换码
- `operate:gift:batch:remove` - 删除批次

## 技术实现

### 前端技术栈
- Vue 3 + TypeScript
- Naive UI 组件库
- 响应式设计，支持移动端

### 组件复用
- 批次操作表单组件可在多个页面复用
- 统一的表格配置和操作逻辑
- 一致的用户体验和交互模式

## 扩展建议

1. **批次模板功能**：支持保存常用的批次配置作为模板
2. **批次统计**：增加批次使用情况的统计图表
3. **批次日志**：记录批次的操作历史
4. **批次状态管理**：更细粒度的批次状态控制
5. **批次分配**：支持将批次分配给不同的渠道或代理商

这个设计方案提供了完整的活动批次管理功能，既支持从活动维度管理批次，也支持全局批次管理，满足了您的所有需求。
